var Tiara_Timer={frames:0,prevTime:(new Date).getTime(),currTime:(new Date).getTime(),dt:0,prevFpsUpdate:0,fpsUpdateFrequency:1,fps:0,getDelta:function(){return this.dt},getFPS:function(){return this.fps},getTime:function(){return(new Date).getTime()},step:function(){this.frames+=1;this.prevTime=this.currTime;this.currTime=this.getTime();this.dt=(this.currTime-this.prevTime)/1E3;if((this.currTime-this.prevFpsUpdate)/1E3>this.fpsUpdateFrequency){this.fps=this.frames/this.fpsUpdateFrequency;this.prevFpsUpdate=
this.currTime;this.frames=0}}},Tiara_Graphics={backgroundColor:{r:255,g:255,b:255},canvas:document.getElementById("tiara"),color:{r:0,g:0,b:0},init:function(){this.canvasContext=this.canvas.getContext("2d");this.clear()},circle:function(a,b,c,d){this.canvasContext.beginPath();this.canvasContext.arc(b,c,d,0,Math.PI*2,false);if(a==="line")this.canvasContext.stroke();else a==="fill"&&this.canvasContext.fill()},clear:function(){this.canvasContext.fillStyle="rgb("+this.backgroundColor.r+", "+this.backgroundColor.g+
", "+this.backgroundColor.b+")";this.canvasContext.fillRect(0,0,this.getWidth(),this.getHeight());this.canvasContext.fillStyle="rgb("+this.color.r+", "+this.color.g+", "+this.color.b+")"},draw:function(a,b,c){this.canvasContext.drawImage(a,b,c)},getBackgroundColor:function(){return this.backgroundColor},getCaption:function(){return document.title},getColor:function(){return this.color},getHeight:function(){return this.canvas.height},getWidth:function(){return this.canvas.width},line:function(a,b,
c,d){this.canvasContext.beginPath();this.canvasContext.moveTo(a,b);this.canvasContext.lineTo(c,d);this.canvasContext.stroke()},newImage:function(a){var b=new Image;b.src=a;return b},print:function(a,b,c){this.canvasContext.fillText(a,b,c)},point:function(a,b){this.canvasContext.fillRect(a,b,1,1)},rectangle:function(a,b,c,d,e){if(a==="line")this.canvasContext.strokeRect(b,c,d,e);else a==="fill"&&this.canvasContext.fillRect(b,c,d,e)},setBackgroundColor:function(a,b,c){this.backgroundColor={r:a,g:b,
b:c}},setCaption:function(a){document.title=a},setColor:function(a,b,c){this.color={r:a,g:b,b:c};this.canvasContext.fillStyle="rgb("+this.color.r+", "+this.color.g+", "+this.color.b+")";this.canvasContext.strokeStyle="rgb("+this.color.r+", "+this.color.g+", "+this.color.b+")"},triangle:function(a,b,c,d,e,f,g){this.canvasContext.beginPath();this.canvasContext.moveTo(b,c);this.canvasContext.lineTo(d,e);this.canvasContext.lineTo(f,g);this.canvasContext.closePath();if(a==="line")this.canvasContext.stroke();
else a==="fill"&&this.canvasContext.fill()}};Tiara_Graphics.init();
var Tiara_Event={Event:{kp:function(a){Tiara.keypressed(a)},q:function(){Tiara.running=false}},push:function(a,b,c,d){this.Event[a]&&this.Event[a](b,c,d)}},Tiara_Keyboard={currentKey:"",KeyConstant:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"escape",32:" ",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",39:"right",38:"up",40:"down",44:"insert",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",
71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"kp0",97:"kp1",98:"kp2",99:"kp3",100:"kp4",101:"kp5",102:"kp6",103:"kp7",104:"kp8",105:"kp9",106:"kp*",107:"kp+",109:"kp-",110:"kp.",111:"kp/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",S48:")",
S49:"!",S50:"@",S51:"#",S52:"$",S53:"%",S54:"^",S55:"&",S56:"*",S57:"(",S59:"(",S186:":",S187:"+",S188:"<",S189:"_",S190:">",S191:"?",S192:"~",S219:"{",S220:"|",S221:"}",S222:'"'},isDown:function(a){return a===this.currentKey}},Tiara={graphics:Tiara_Graphics,event:Tiara_Event,keyboard:Tiara_Keyboard,timer:Tiara_Timer,running:true,load:function(a){this.game=a;myself=this;myself.update();setInterval("myself.update()",1)},draw:function(){this.graphics.clear();this.game.draw()},update:function(){if(this.running){this.timer.step();
this.game.update(this.timer.getDelta());this.draw()}},keypressed:function(a,b){Tiara.keyboard.currentKey=a;typeof this.game.keypressed==="function"&&this.game.keypressed(a,b)},keyreleased:function(a,b){Tiara.keyboard.currentKey="";typeof this.game.keyreleased==="function"&&this.game.keyreleased(a,b)}};document.onkeydown=function(a){keyCode=a.keyCode;if(a.shiftKey)keyCode="S"+a.keyCode;Tiara.keypressed(Tiara.keyboard.KeyConstant[keyCode],keyCode)};
document.onkeyup=function(a){keyCode=a.keyCode;if(a.shiftKey)keyCode="S"+a.keyCode;Tiara.keyreleased(Tiara.keyboard.KeyConstant[keyCode],keyCode)};